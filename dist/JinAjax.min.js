+function(){"use strict";var t=function(t){this.obj=t,this.init()};t.prototype.getParam=function(){this.obj=this.obj||{},this.obj.methods=this.obj.methods||"GET",this.obj.methods=this.obj.methods.toUpperCase(),this.obj.url=this.obj.url||"",this.obj.data=this.obj.data||null,this.obj.header=this.obj.header||null,this.obj.timeout=this.obj.timeout||1e4,this.obj.type=this.obj.type||"json",this.obj.jsonp=this.obj.jsonp||"callback",this.obj.success=this.obj.success||function(t){console.log(t)},this.obj.error=this.obj.error||function(t){console.log(t)},this.obj.before=this.obj.before||function(){},this.flag="",this.timeoutBool=!1},t.prototype.getXHR=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;for(var t=["Microsoft","msxm3","msxml2","msxml1"],o=0;o<t.length;o++)try{var e=t[o]+".XMLHTTP";return new ActiveXObject(e)}catch(t){console.log("error ajax",t)}},t.prototype.timeOutSet=function(t,o){var e=this,s=setTimeout(function(){e.obj.error("request timeout more than "+e.obj.timeout+"ms"),e.timeoutBool=!0,"jsonp"===e.obj.type?document.body.removeChild(o):t.abort()},e.obj.timeout);this.flag=s},t.prototype.setHeader=function(t){for(var o in this.obj.header)t.setRequestHeader(o,this.obj.header[o])},t.prototype.createXHR=function(){var t=this,o=this.getXHR();o.open(this.obj.methods,this.obj.url,this.obj.async),this.timeOutSet(o,0),this.setHeader(o),o.onreadystatechange=function(){if(4===o.readyState){if(t.timeoutBool)return;if(clearTimeout(t.flag),o.status>=200&&o.status<300||304==o.status){var e=o.responseText;try{o.responseText&&(e=JSON.parse(e)),obj.success(e)}catch(t){obj.error(o)}}else obj.error(o)}},o.send("GET"===obj.methods?null:obj.data)},t.prototype.setJsonp=function(){var t=this,o=document.createElement("script");window.callback=function(e){document.body.removeChild(o),clearTimeout(t.flag);try{}catch(o){t.obj.error(o)}t.obj.success(e)},o.src=this.obj.url+(this.obj.url.indexOf("?")>-1?"":"?")+t.obj.jsonp+"=callback",o.type="text/javascript",document.body.appendChild(o),this.timeOutSet(0,o)},t.prototype.init=function(){this.getParam(),this.obj.before(),"jsonp"===this.obj.type?this.setJsonp():this.createXHR()},window.JinAjax=t}();